---
# Helm values for deploying Camunda Platform with Bitnami sub-charts.
# This is the "source" deployment used as the starting point for migration tests.
#
# For domain mode (Ingress + TLS), layer bitnami-values-domain.yml on top.
#
# Chart: camunda/camunda-platform (13.x / Camunda 8.8+)
# Usage: helm install camunda camunda/camunda-platform -f bitnami-values.yml
#
# Images use the Camunda vendor-ee registry (enterprise Bitnami-based images with
# CVE patches) instead of upstream Bitnami to avoid availability issues with
# bitnamilegacy registry.
#
# Versions are pinned to match the operator-based target manifests to ensure
# migration version validation passes. When updating operator versions,
# update these values accordingly.

global:
    secrets:
        autoGenerated: true
    security:
        # Required for vendor-ee images (not signed by Bitnami)
        allowInsecureImages: true
    identity:
        auth:
            enabled: true
            optimize:
                secret:
                    existingSecret: camunda-credentials
                    existingSecretKey: identity-optimize-client-token
    image:
        registry: registry.camunda.cloud
        pullSecrets:
            - name: registry-camunda-cloud
            - name: index-docker-io

# Elasticsearch — vendor-ee image, pinned to match ECK target (8.19.x)
elasticsearch:
    enabled: true
    image:
        registry: registry.camunda.cloud
        repository: vendor-ee/elasticsearch
        # renovate: datasource=docker depName=registry.camunda.cloud/vendor-ee/elasticsearch
        tag: 8.19.11
        pullSecrets:
            - name: registry-camunda-cloud

# PostgreSQL for Identity (renamed from postgresql to identityPostgresql in 8.8)
identityPostgresql:
    enabled: true
    image:
        registry: registry.camunda.cloud
        repository: vendor-ee/postgresql
        # renovate: datasource=docker depName=registry.camunda.cloud/vendor-ee/postgresql
        tag: 15.15.0-debian-12-r2
        pullSecrets:
            - name: registry-camunda-cloud
    auth:
        username: identity
        database: identity
        existingSecret: camunda-credentials

identity:
    enabled: true

# Keycloak — vendor-ee image, pinned to match Keycloak Operator target
identityKeycloak:
    enabled: true
    image:
        registry: registry.camunda.cloud
        repository: keycloak-ee/keycloak
        # renovate: datasource=docker depName=registry.camunda.cloud/keycloak-ee/keycloak
        tag: 26.3.2
        pullSecrets:
            - name: registry-camunda-cloud
    postgresql:
        enabled: true
        image:
            registry: registry.camunda.cloud
            repository: vendor-ee/postgresql
            tag: 15.15.0-debian-12-r2
            pullSecrets:
                - name: registry-camunda-cloud
        auth:
            username: keycloak
            password: keycloak-password
            database: keycloak

# WebModeler with SMTP stub (required for Camunda 8.8+)
webModeler:
    enabled: true
    restapi:
        mail:
            smtpHost: smtp.example.com
            smtpPort: 587
            smtpUser: test@example.com
            fromAddress: noreply@example.com
            secret:
                inlineSecret: placeholder

# PostgreSQL for WebModeler — vendor-ee image
webModelerPostgresql:
    enabled: true
    image:
        registry: registry.camunda.cloud
        repository: vendor-ee/postgresql
        # renovate: datasource=docker depName=registry.camunda.cloud/vendor-ee/postgresql
        tag: 14.21.0-debian-12-r0
        pullSecrets:
            - name: registry-camunda-cloud
    auth:
        username: webmodeler
        database: webmodeler
        existingSecret: camunda-credentials

optimize:
    enabled: true

# Orchestration cluster (replaces zeebe, operate, tasklist in 8.8+)
orchestration:
    enabled: true
