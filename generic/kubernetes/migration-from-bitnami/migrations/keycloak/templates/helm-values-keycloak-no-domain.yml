---
# Helm values for Keycloak Operator without Domain (Local/Development)
# Based on: operator-based/keycloak/camunda-keycloak-no-domain-values.yml
# Usage: envsubst < helm-values-keycloak-no-domain.yml > values-keycloak.yaml
#        helm upgrade camunda camunda/camunda-platform --reuse-values -f values-keycloak.yaml

global:
    security:
        authentication:
            method: oidc

    # Identity configuration for authentication
    identity:
        auth:
            enabled: true
            type: KEYCLOAK
            issuerBackendUrl: http://keycloak-service:8080/auth/realms/camunda-platform
            issuer: http://keycloak-service:8080/auth/realms/camunda-platform
            # Local testing with port-forwarding
            # using localhost:18080 -> keycloak-service:8080 (kubectl port-forward svc/keycloak-service 18080:8080)
            publicIssuerUrl: http://localhost:18080/auth/realms/camunda-platform

        # Keycloak configuration for external instance
        keycloak:
            # For external Keycloak managed by operator
            internal: false
            url:
                protocol: http
                host: keycloak-service
                port: '8080'
            contextPath: /auth
            realm: /realms/camunda-platform
            auth:
                # For operator-managed Keycloak, use the generated admin secret
                existingSecret: keycloak-initial-admin
                existingSecretKey: password
                adminUser: temp-admin

orchestration:
    security:
        authentication:
            oidc:
                redirectUrl: http://localhost:8080

# Disable Bitnami Keycloak
identityKeycloak:
    enabled: false

identity:
    enabled: true
    contextPath: /managementidentity
