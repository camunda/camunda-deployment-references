---
# TODO: [release-duty] when release update the link with the related Camunda version of the release
# keep it synced with https://github.com/camunda/camunda-platform-helm/blob/main/charts/camunda-platform-8.8/test/integration/scenarios/common/values-integration-test.yaml
# it generates the CI user used to connect to the platform
identity:
    env:
        - name: KEYCLOAK_CLIENTS_2_ID
          value: venom
        - name: KEYCLOAK_CLIENTS_2_NAME
          value: Venom
        - name: KEYCLOAK_CLIENTS_2_SECRET
          valueFrom:
              secretKeyRef:
                  # adjusted to align with our tests
                  name: identity-secret-for-components-integration
                  key: identity-admin-client-secret
        - name: KEYCLOAK_CLIENTS_2_REDIRECT_URIS_0
          value: /dummy
        - name: KEYCLOAK_CLIENTS_2_ROOT_URL
          value: http://dummy
        - name: KEYCLOAK_CLIENTS_2_TYPE
          value: CONFIDENTIAL
        # Identity access.
        - name: KEYCLOAK_CLIENTS_2_PERMISSIONS_0_RESOURCE_SERVER_ID
          value: camunda-identity-resource-server
        - name: KEYCLOAK_CLIENTS_2_PERMISSIONS_0_DEFINITION
          value: read
        - name: KEYCLOAK_CLIENTS_2_PERMISSIONS_1_RESOURCE_SERVER_ID
          value: camunda-identity-resource-server
        - name: KEYCLOAK_CLIENTS_2_PERMISSIONS_1_DEFINITION
          value: write
        # Orchestration access.
        - name: KEYCLOAK_CLIENTS_2_PERMISSIONS_2_RESOURCE_SERVER_ID
          value: orchestration-api
        - name: KEYCLOAK_CLIENTS_2_PERMISSIONS_2_DEFINITION
          value: read:*
        - name: KEYCLOAK_CLIENTS_2_PERMISSIONS_3_RESOURCE_SERVER_ID
          value: orchestration-api
        - name: KEYCLOAK_CLIENTS_2_PERMISSIONS_3_DEFINITION
          value: write:*
        # Optimize access.
        - name: KEYCLOAK_CLIENTS_2_PERMISSIONS_4_RESOURCE_SERVER_ID
          value: optimize-api
        - name: KEYCLOAK_CLIENTS_2_PERMISSIONS_4_DEFINITION
          value: write:*
        # WebModeler access.
        - name: KEYCLOAK_CLIENTS_2_PERMISSIONS_5_RESOURCE_SERVER_ID
          value: web-modeler-api
        - name: KEYCLOAK_CLIENTS_2_PERMISSIONS_5_DEFINITION
          value: write:*
        # Console access.
        - name: KEYCLOAK_CLIENTS_2_PERMISSIONS_6_RESOURCE_SERVER_ID
          value: console-api
        - name: KEYCLOAK_CLIENTS_2_PERMISSIONS_6_DEFINITION
          value: write:*

# We need to add a mapping for embedded identity
# this will also overwrite the default mapping for demo user, so we need to readd it again
# by default the Helm Chart adds any mapping to the admin role
orchestration:
    security:
        initialization:
            mappingRules:
                - mappingRuleID: venom-test-client-mapping
                  claimName: client_id
                  claimValue: venom
                - mappingRuleID: demo-user-mapping-rule
                  claimName: preferred_username
                  claimValue: demo

    #################### Only needed for keycloak auth
    env:
        - name: CAMUNDA_SECURITY_INITIALIZATION_MAPPINGRULES_0_MAPPINGRULEID
          value: demo-user-mapping-rule
        - name: CAMUNDA_SECURITY_INITIALIZATION_MAPPINGRULES_0_CLAIMNAME
          value: preferred_username
        - name: CAMUNDA_SECURITY_INITIALIZATION_MAPPINGRULES_0_CLAIMVALUE
          value: demo
        - name: CAMUNDA_SECURITY_INITIALIZATION_MAPPINGRULES_1_MAPPINGRULEID
          value: venom-client-mapping-rule
        - name: CAMUNDA_SECURITY_INITIALIZATION_MAPPINGRULES_1_CLAIMNAME
          value: client_id
        - name: CAMUNDA_SECURITY_INITIALIZATION_MAPPINGRULES_1_CLAIMVALUE
          value: venom
        - name: CAMUNDA_SECURITY_INITIALIZATION_MAPPINGRULES_2_MAPPINGRULEID
          value: connectors-client-mapping-rule
        - name: CAMUNDA_SECURITY_INITIALIZATION_MAPPINGRULES_2_CLAIMNAME
          value: client_id
        - name: CAMUNDA_SECURITY_INITIALIZATION_MAPPINGRULES_2_CLAIMVALUE
          value: connectors
        - name: CAMUNDA_SECURITY_INITIALIZATION_DEFAULTROLES_ADMIN_MAPPINGRULES_0
          value: demo-user-mapping-rule
        - name: CAMUNDA_SECURITY_INITIALIZATION_DEFAULTROLES_ADMIN_MAPPINGRULES_1
          value: venom-client-mapping-rule
        - name: CAMUNDA_SECURITY_INITIALIZATION_DEFAULTROLES_ADMIN_MAPPINGRULES_2
          value: connectors-client-mapping-rule
