---
global:
    elasticsearch:
        enabled: true

    identity:

        auth:
            enabled: true
            type: KEYCLOAK
            # using localhost:18080 -> camunda-keycloak:8080
            publicIssuerUrl: http://localhost:18080/auth/realms/camunda-platform  # replace this with a port of your choice when you will do port forwarding

            orchestration:
                secret:
                    existingSecret: identity-secret-for-components
                    existingSecretKey: identity-orchestration-client-token
                redirectUrl: http://localhost:8082  # replace this with a port of your choice when you will do port forwarding

            admin:
                secret:
                    existingSecret: identity-secret-for-components
                    existingSecretKey: identity-admin-client-token

            connectors:
                secret:
                    existingSecret: identity-secret-for-components
                    existingSecretKey: identity-connectors-client-token

            optimize:
                secret:
                    existingSecret: identity-secret-for-components
                    existingSecretKey: identity-optimize-client-token
                redirectUrl: http://localhost:8083  # replace this with a port of your choice when you will do port forwarding

            webModeler:
                secret:
                    existingSecret: identity-secret-for-components
                    existingSecretKey: identity-webmodeler-client-token
                redirectUrl: http://localhost:8084

            console:
                secret:
                    existingSecret: identity-secret-for-components
                    existingSecretKey: identity-console-client-token
                redirectUrl: http://localhost:8085

identityKeycloak:
    enabled: true
    postgresql:
        enabled: false
    externalDatabase:
        # see https://artifacthub.io/packages/helm/bitnami/keycloak
        existingSecret: identity-keycloak-secret   # Name of an existing secret resource containing the database credentials
        existingSecretHostKey: host
        existingSecretPortKey: port
        existingSecretUserKey: user
        existingSecretDatabaseKey: database
        existingSecretPasswordKey: password

    auth:
        existingSecret: identity-secret-for-components
        passwordSecretKey: identity-admin-client-token


identity:
    enabled: true
    contextPath: /managementidentity
    fullURL: http://localhost:8080/managementidentity # replace this with a port of your choice when you will do port forwarding

    externalDatabase:
        enabled: true
        host: ${DB_HOST}
        port: ${DB_PORT}
        username: ${DB_IDENTITY_USERNAME}
        database: ${DB_IDENTITY_NAME}
        secret:
            existingSecret: identity-postgres-secret
            existingSecretPasswordKey: password

connectors:
    image:
        tag: 8.8-SNAPSHOT # TODO: remove! <8.8>

    # Configure OIDC for connectors
    security:
        authentication:
            oidc:
                secret:
                    existingSecret: identity-secret-for-components
                    existingSecretKey: identity-connectors-client-token

orchestration:
    image:
        tag: 8.8-SNAPSHOT # TODO: remove! <8.8>

    # Configure OIDC for orchestration
    security:
        authentication:
            method: oidc
            redirectUrl: http://localhost:18080
            oidc:
                secret:
                    existingSecret: identity-secret-for-components
                    existingSecretKey: identity-orchestration-client-token

webModeler:
    enabled: false # by default, webModeler is not enabled

    restapi:
        externalDatabase:
            url: jdbc:postgresql://${DB_HOST}:5432/${DB_WEBMODELER_NAME}?sslmode=require
            user: ${DB_WEBMODELER_USERNAME}
            secret:
                existingSecret: webmodeler-postgres-secret
                existingSecretPasswordKey: password

        mail:
            secret:
                existingSecret: identity-secret-for-components
                existingSecretKey: smtp-password
            fromAddress: changeme@example.com

webModelerPostgresql:
    # Will deploy a postgresql datbase for webModeler.
    # If you enable webModeler, you either need to turn it true or use an external database
    enabled: false
    auth:
        existingSecret: identity-secret-for-components
        secretKeys:
            adminPasswordKey: identity-webmodeler-postgres-admin-password
            userPasswordKey: identity-webmodeler-postgres-user-password

console:
    enabled: false # by default, console is not enabled

elasticsearch:
    enabled: true
